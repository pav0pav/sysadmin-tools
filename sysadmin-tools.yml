---
  - hosts: local
    vars:
      - username: pav # change THIS!!
      - home: /home/pav # change THIS!!
    become: true
    tasks:
      - name: Run the equivalent of "apt-get update" as a separate step
        apt:
          update_cache: yes
      - name: Upgrade all packages to the latest version
        apt:
          name: "*"
          state: latest
      - name: Remove useless packages from the cache
        apt:
          autoclean: yes
      - name: Remove dependencies that are no longer required
        apt:
          autoremove: yes
      - name: Install favourite tools
        apt: 
          pkg: 
            - iperf3
            - iftop
            - mtr
            - htop
            - tilix
            - micro
            - ncdu
          state: present 
          update_cache: yes
      - name: install snap packages
        snap:
          name:
            - fast
            - code
            - btop
            - starship    
          classic: yes
      - name: Create starship config file
        file:
          path: "/{{ home }}/.config/starship.toml"
          state: touch
      - name: Copy config from template - starship
        template:
          src: "/home/pav/git_repos/sysadmin-tools/templates/starship.toml"
          dst: "/home/pav/.config/starship.toml"
          owner: "{{ username }}"
          group: "{{ username }}"
          mode: 0664
      - name: Create yaml.nanorc
        file:
          path: "/usr/share/nano/yaml.nanorc"
          state: touch
      - name: Copy config from template - nano
        template: 
          src: "/{{ home }}/git_repos/sysadmin-tools/templates/yaml.nanorc.j2"
          dest: "/usr/share/nano/yaml.nanorc"
          owner: root
          group: root
          mode: 0644
      - name: git branch name in bash
        blockinfile:
          dest: "/{{ home }}/.bashrc"
          block: |
            # Show current git branch in command line
            parse_git_branch() {
            git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/ (\1)/'
            }
            export PS1="\[\033[32m\]\w\[\033[33m\]\$(parse_git_branch)\[\033[00m\] $ "
          backup: yes 